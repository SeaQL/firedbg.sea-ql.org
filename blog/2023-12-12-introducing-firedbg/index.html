<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Introducing FireDBG for Rust | FireDBG - ðŸ”¥ Time Travel Visual Debugger for Rust</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://firedbg.sea-ql.org/blog/2023-12-12-introducing-firedbg/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Introducing FireDBG for Rust | FireDBG - ðŸ”¥ Time Travel Visual Debugger for Rust"><meta data-rh="true" name="description" content="Debugging programs is hard"><meta data-rh="true" property="og:description" content="Debugging programs is hard"><meta data-rh="true" property="og:image" content="https://firedbg.sea-ql.org/img/banner-introducing-firedbg.png"><meta data-rh="true" name="twitter:image" content="https://firedbg.sea-ql.org/img/banner-introducing-firedbg.png"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-12-12T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/tyt2y3"><meta data-rh="true" property="article:tag" content="news"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://firedbg.sea-ql.org/blog/2023-12-12-introducing-firedbg/"><link data-rh="true" rel="alternate" href="https://firedbg.sea-ql.org/blog/2023-12-12-introducing-firedbg/" hreflang="en"><link data-rh="true" rel="alternate" href="https://firedbg.sea-ql.org/blog/2023-12-12-introducing-firedbg/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="FireDBG - ðŸ”¥ Time Travel Visual Debugger for Rust RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="FireDBG - ðŸ”¥ Time Travel Visual Debugger for Rust Atom Feed">




<script src="/firedbg.js"></script><link rel="stylesheet" href="/assets/css/styles.b3489cfd.css">
<link rel="preload" href="/assets/js/runtime~main.447e8809.js" as="script">
<link rel="preload" href="/assets/js/main.c4b29fd9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/FireDBG.png" alt="FireDBG Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/FireDBG.png" alt="FireDBG Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">FireDBG</b></a><a class="navbar__item navbar__link" href="/install/">Install</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://marketplace.visualstudio.com/items?itemName=SeaQL.firedbg-rust" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">VS Code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/SeaQL/FireDBG.for.Rust" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All Posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024-06-30-fizzbuzz-multithread/">FizzBuzz Multithreaded - synchronization with rendezvous channels</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2024-01-31-visual-dynamic-program/">Visualizing Dynamic Programming - Part 1</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023-12-13-getting-started/">Getting Started</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/blog/2023-12-12-introducing-firedbg/">Introducing FireDBG for Rust</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2023-12-11-architecture-of-firedbg/">Architecture of FireDBG</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Debugging programs is hard"><link itemprop="image" href="https://firedbg.sea-ql.org/img/banner-introducing-firedbg.png"><header><h1 class="title_f1Hy" itemprop="headline">Introducing FireDBG for Rust</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-12-12T00:00:00.000Z" itemprop="datePublished">December 12, 2023</time> Â· <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/tyt2y3" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/1782664?v=4" alt="Chris Tsang" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/tyt2y3" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Chris Tsang</span></a></div><small class="avatar__subtitle" itemprop="description">FireDBG Team</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="debugging-programs-is-hard">Debugging programs is hard<a href="#debugging-programs-is-hard" class="hash-link" aria-label="Direct link to Debugging programs is hard" title="Direct link to Debugging programs is hard">â€‹</a></h2><p>Debugging programs is hard. It is extremely mind boggling when something does not work as expected. More often than not 90% of the work is on tracking down <em>where</em> the bug is, and 10% is actually solving it!</p><p>But why don&#x27;t programmers use debuggers more often these days? Instead, we all enjoy adding <code>println</code> all over the place, running the program, adding more prints, rinse and repeat, just to find out that we still haven&#x27;t printed the key variable and may even need to make guesses about the program state while drowning in the logs.</p><p>A running program is like a blackbox to us, and the console is our only window into its internal states. However, at the end of the day, it is still the programmer&#x27;s responsibility to print the relevant information.</p><p>How does a debugger help us debug a program? We identified that it usually comes down to:</p><ul><li>Where did the control flow of my program go?</li><li>Where do my errors come from?</li><li>What are inside my variables?</li><li>What happened in what order?</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="thats-why-we-created-firedbg---a-time-travel-visual-debugger-for-rust-">That&#x27;s why we created FireDBG - a Time Travel Visual Debugger for Rust ðŸŽ¬<a href="#thats-why-we-created-firedbg---a-time-travel-visual-debugger-for-rust-" class="hash-link" aria-label="Direct link to That&#x27;s why we created FireDBG - a Time Travel Visual Debugger for Rust ðŸŽ¬" title="Direct link to That&#x27;s why we created FireDBG - a Time Travel Visual Debugger for Rust ðŸŽ¬">â€‹</a></h3><video controls="" muted="" autoplay="" loop="" style="width:100%" data-theme="light"><source src="/img/quicksort-mac-light.mp4" type="video/mp4"></video><video controls="" muted="" autoplay="" loop="" style="width:100%" data-theme="dark"><source src="/img/quicksort-mac-dark.mp4" type="video/mp4"></video><h2 class="anchor anchorWithStickyNavbar_LWe7" id="time-travel-debugging">Time travel debugging<a href="#time-travel-debugging" class="hash-link" aria-label="Direct link to Time travel debugging" title="Direct link to Time travel debugging">â€‹</a></h2><p>According to Wikipedia, time travel debugging is the process of stepping back in time through source code to understand what is happening during execution of a computer program. Unlike &quot;traditional&quot; debuggers which can only step forward, time travel debuggers allow us to step backward and see the cause and effects.</p><p>Time travel debuggers exist<sup id="fnref-1-3c097c"><a href="#fn-1-3c097c" class="footnote-ref">1</a></sup>, and they usually work by recording data on the instruction level. But that would result in a gigantic amount of data, so now the question is: how do we make sense of this data and <em>navigate through time</em> effectively?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="call-tree---the-trail-across-the-forest">Call tree - the trail across the forest<a href="#call-tree---the-trail-across-the-forest" class="hash-link" aria-label="Direct link to Call tree - the trail across the forest" title="Direct link to Call tree - the trail across the forest">â€‹</a></h2><p>Let&#x27;s take a look at the following call tree for an implementation of quicksort:</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">pub</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">run</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PartialOrd</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> len </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">len</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">quick_sort</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">len </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">isize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">quick_sort</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PartialOrd</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> low</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">isize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> high</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">isize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> low </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> high </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">partition</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> low</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> high</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">quick_sort</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> low</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">quick_sort</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> p </span><span class="token operator" style="color:rgb(0, 0, 0)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> high</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">partition</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PartialOrd</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token class-name" style="color:rgb(38, 127, 153)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> low</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">isize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> high</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">isize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">isize</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> pivot </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> high </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> store_index </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> low </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> last_index </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> high</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">loop</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        store_index </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">while</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">store_index </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">pivot</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            store_index </span><span class="token operator" style="color:rgb(0, 0, 0)">+=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        last_index </span><span class="token operator" style="color:rgb(0, 0, 0)">-=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">while</span><span class="token plain"> last_index </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;&amp;</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">last_index </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">pivot</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            last_index </span><span class="token operator" style="color:rgb(0, 0, 0)">-=</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> store_index </span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;=</span><span class="token plain"> last_index </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            </span><span class="token keyword" style="color:rgb(0, 0, 255)">break</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">            arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">swap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">store_index </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> last_index </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    arr</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">swap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">store_index </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> pivot </span><span class="token keyword" style="color:rgb(0, 0, 255)">as</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">usize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    store_index</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/quicksort-light.png#light"><img style="width:100%" src="/img/quicksort-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">FireDBG screenshot for an <a href="https://github.com/SeaQL/FireDBG.Rust.Testbench/tree/main/quicksort" target="_blank" rel="noopener noreferrer">implementation of quicksort</a></td></tr></tbody></table><p>If you instantly get it, you can skip this section! If not, let&#x27;s go through it step by step:</p><blockquote><p>&quot;A call tree is all the state transitions of a program&#x27;s call stack laid out on a 2D plane, organized in form of a tree&quot;</p></blockquote><p>Every time a function call is made, we create a child node; when the function returns, we go back to the parent node. So subsequent function calls become sibling nodes.</p><video controls="" muted="" autoplay="" loop="" style="width:100%" data-theme="light"><source src="/img/calltree-light.mp4" type="video/mp4"></video><video controls="" muted="" autoplay="" loop="" style="width:100%" data-theme="dark"><source src="/img/calltree-dark.mp4" type="video/mp4"></video><p></p><p>At any given node, traversing up to the root node gives us a chain - which is the call stack.
We have two notations, <code>--&gt;--</code> for function calls; <code>--&lt;-&gt;--</code> for function calls with return values.
We assign a unique frame ID to each node and this is the time sequence used in the timebar.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="call-tree-visualization-and-algorithms">Call tree visualization and algorithms<a href="#call-tree-visualization-and-algorithms" class="hash-link" aria-label="Direct link to Call tree visualization and algorithms" title="Direct link to Call tree visualization and algorithms">â€‹</a></h2><p>FireDBG is built around the call tree. You may ask, wouldn&#x27;t this call tree become very large? Yes, that&#x27;s why we spent enormous effort into linearizing everything. We developed a streaming file format to process the data in real time, and figured out a layout algorithm that can render infinite trees.</p><p>What&#x27;s so interesting about call trees? Their shapes reveal a lot about the properties of algorithms. To illustrate, here&#x27;s a side-by-side comparison of quicksort and mergesort, and we can see that quicksort yields a deeper tree than mergesort<sup id="fnref-2-3c097c"><a href="#fn-2-3c097c" class="footnote-ref">2</a></sup>. So quicksort is using more stack memory<sup id="fnref-3-3c097c"><a href="#fn-3-3c097c" class="footnote-ref">3</a></sup> than mergesort, which makes sense because mergesort uses some memory on the heap!</p><p>Since both are binary trees, they are not tail-call optimizable. And since both algorithms claim to be of <code>O(n log n)</code>, statistically only one of the two branches should grow deeper. There are a lot more to observe and I have been drawing this on paper by hand for many years.</p><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/quicksort-vs-mergesort-light.png#light"><img style="width:100%" src="/img/quicksort-vs-mergesort-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">Comparing <a href="https://github.com/SeaQL/FireDBG.Rust.Testbench/tree/main/quicksort" target="_blank" rel="noopener noreferrer">quicksort</a> and <a href="https://github.com/SeaQL/FireDBG.Rust.Testbench/tree/main/mergesort" target="_blank" rel="noopener noreferrer">mergesort</a> side by side with the same input</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tracing-errors---the-error-path">Tracing errors - the error path<a href="#tracing-errors---the-error-path" class="hash-link" aria-label="Direct link to Tracing errors - the error path" title="Direct link to Tracing errors - the error path">â€‹</a></h2><p>This might be a Rust specific problem: Rust don&#x27;t have exceptions. Instead, Rust uses a <code>Result</code> system coupled with the ergonmic <code>?</code> operator to effectively signal and handle errors. This has both pros and cons - the good thing is that errors propagate back to the parent along the exact same path the function is being called, which is deterministic and predictable. The bad thing is, when you finally <code>unwrap</code> an error and decide to panic, the context of the error has long been lost.</p><p>This echos our second question: where do my errors come from? Consider the following toy program, where we get to roll some dice and each time we could be rolling one, two or three dice. Once in a while, throwing a die can cause an error. This is deliberately randomized, so there is no way to statically analyze where the error might come from - such is life!</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">roll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token namespace">fire</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token macro property">dbg!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token namespace">fastrand</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">u32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token number" style="color:rgb(9, 134, 88)">4</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">roll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">throw</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">throw</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">match</span><span class="token plain"> </span><span class="token namespace">fire</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token macro property">dbg!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token namespace">fastrand</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..=</span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> a </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token number" style="color:rgb(9, 134, 88)">3</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">a</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> a</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> b</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> c</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        _ </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> </span><span class="token macro property">unreachable!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token namespace">fire</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token macro property">dbg!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token namespace">fastrand</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">bool</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">roll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token function" style="color:rgb(0, 0, 255)">throw</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i </span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">dice</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Result</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">if</span><span class="token plain"> </span><span class="token namespace">fire</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token macro property">dbg!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token namespace">fastrand</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token keyword" style="color:rgb(0, 0, 255)">i32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">==</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Err</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">roll</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">25</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>FireDBG captures all functions&#x27; return values and so is able to locate where the error originated from and how it propagated up! Here is the rendered call tree of this <code>roll_dice</code> program, where FireDBG is able to highlight the error path up until the point of panic, which is conveniently marked by <code>!</code>:</p><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/roll_dice-light.png#light"><img style="width:100%" src="/img/roll_dice-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">A screenshot of the <a href="https://github.com/SeaQL/FireDBG.Rust.Testbench/tree/main/roll_dice" target="_blank" rel="noopener noreferrer"><code>roll_dice</code></a> call tree</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="collecting-parameters-and-return-values">Collecting parameters and return values<a href="#collecting-parameters-and-return-values" class="hash-link" aria-label="Direct link to Collecting parameters and return values" title="Direct link to Collecting parameters and return values">â€‹</a></h2><p>As you have seen in the above screenshots, FireDBG captures all functions&#x27; parameters and return values. Capturing parameters is the easy part, because it&#x27;s a basic feature of any debuggers<sup id="fnref-4-3c097c"><a href="#fn-4-3c097c" class="footnote-ref">4</a></sup>. But capturing return values is a little intricate. The current implementation is: we set a breakpoint at every <code>ret</code> instruction and capture the return value at that <em>particular</em> point in time. The next instruction will immediately jump back to the parent function, which may overwrite the value.</p><p>Let&#x27;s talk about ABI. There are different call conventions and Rust is particularly flexible in whether a value is returned via stack or register. In some cases complex data can be packed into one register, because Rust can return complex types like tuples and unions<sup id="fnref-5-3c097c"><a href="#fn-5-3c097c" class="footnote-ref">5</a></sup>. We tried super hard, but return value capture is still a hit-or-miss, but some visibility is better than no visibility!</p><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/quicksort-partition-light.png#light"><img style="width:100%" src="/img/quicksort-partition-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">Inspecting the parameters and return value of the <code>partition</code> function</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-type-system-for-the-rust-type-system">A type system for the Rust type system<a href="#a-type-system-for-the-rust-type-system" class="hash-link" aria-label="Direct link to A type system for the Rust type system" title="Direct link to A type system for the Rust type system">â€‹</a></h2><p>We rely on lldb&#x27;s awesome <code>SBType</code> API to parse Rust&#x27;s debug symbols, and capture variables&#x27; values in binary forms - not all things are printable, in particular, pointers (references) and containers. We have to reference the memory locations to get their values. This becomes non-trivial if the references form a diamond or worse, cycles<sup id="fnref-6-3c097c"><a href="#fn-6-3c097c" class="footnote-ref">6</a></sup>.</p><p>For pointers, our brilliant intern<sup id="fnref-7-3c097c"><a href="#fn-7-3c097c" class="footnote-ref">7</a></sup> has a great idea - capture and store the pointees as context for each variable and dereference those pointers on replay. Each memory address will only be serialized once, but can be copied many times on deserialization.</p><p>As such, we were able to construct a type system that can <a href="https://github.com/SeaQL/FireDBG.for.Rust/blob/main/protocol/src/value.rs" target="_blank" rel="noopener noreferrer">represent Rust values</a>, which are serialized as binary data. We can then visualize them beautifully!</p><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/car-light.png#light"><img style="width:100%" src="/img/car-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">The <a href="https://github.com/SeaQL/FireDBG.for.Rust/blob/main/debugger/testcases/object.rs" target="_blank" rel="noopener noreferrer"><code>Car</code> data structure</a> with visualization; left panel: Rust definition</td></tr></tbody></table><p>For containers, it is more murky. For vectors, we can simply read a blob of memory from the heap, because the items are contiguous. But ... how about hash maps? Luckily, in Rust, the standard library&#x27;s hashmap is a <a href="https://github.com/rust-lang/hashbrown" target="_blank" rel="noopener noreferrer">flat hashmap</a>, which means items are densely packed, although not contiguous. So with some <a href="https://github.com/tyt2y3/frozen-hashbrown" target="_blank" rel="noopener noreferrer">memory fiddling</a>, we are able to capture the contents of hashmaps!</p><p>Note that in the screenshot below, the hash key is <code>&amp;str</code>, which means after extracting the hash keys from the hash map, we have to dereference the pointers to retrieve the string content.</p><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/hashmap-light.png#light"><img style="width:100%" src="/img/hashmap-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">Left panel: captured hashmap; middle panel: rendered hashmap; right panel: raw representation of a hashmap</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-new-lens-into-our-code">A new lens into our code<a href="#a-new-lens-into-our-code" class="hash-link" aria-label="Direct link to A new lens into our code" title="Direct link to A new lens into our code">â€‹</a></h2><p>Visualization is a new lens into our code. Above are just a few simple examples, and FireDBG opens the door to domain-specific visualizations that are meaningful to us. Below are a few more examples:</p><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/sudoku-light.png#light"><img style="width:100%" src="/img/sudoku-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">A <a href="https://github.com/SeaQL/FireDBG.Rust.Testbench/tree/main/sudoku" target="_blank" rel="noopener noreferrer">Sudoku solver</a></td></tr></tbody></table><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/tokenizer-light.png#light"><img style="width:100%" src="/img/tokenizer-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">A <a href="https://github.com/SeaQL/sea-query/blob/master/src/token.rs" target="_blank" rel="noopener noreferrer">SQL tokenizer</a></td></tr></tbody></table><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/bubble-code-light.png#light"><img style="width:100%" src="/img/bubble-code-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">My personal favourite - <a href="https://github.com/SeaQL/FireDBG.Rust.Testbench/tree/main/bubble-code" target="_blank" rel="noopener noreferrer">symbolic recognition</a></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="i-want-to-debug-my-code---not-system-libraries">I want to debug <em>my code</em> - not system libraries!<a href="#i-want-to-debug-my-code---not-system-libraries" class="hash-link" aria-label="Direct link to i-want-to-debug-my-code---not-system-libraries" title="Direct link to i-want-to-debug-my-code---not-system-libraries">â€‹</a></h2><p>We tried our best to boost the signal-to-noise ratio. Instead of <code>alloc::sync::Arc { core::ptr::non_null::NonNull { alloc::sync::ArcInner { strong: core::sync::atomic::AtomicUsize { .. }, weak: core::sync::atomic::AtomicUsize { .. }, data: pointer::Object { .. } } } }</code>, we try to prettify standard library types like <code>Arc</code> as <code>RefCounted { strong: 1usize, weak: 1usize, value: pointer::Object { .. } }</code>.</p><p>FireDBG only traces user code - not standard library, not vendor libraries - only the code inside the specific crate you are currently programming. Which means the call tree will only contain functions you wrote. No implementation details like <code>&lt;I as alloc::vec::in_place_collect::SpecInPlaceCollect&lt;T,I&gt;&gt;::collect_in_place</code>.</p><p>Which also means that the overhead of program tracing is confined - even with a very complex program, the subset of user code that we want to trace would only be a fraction of the program binary.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="multi-threaded-programming-">Multi-threaded programming ðŸŽ¬<a href="#multi-threaded-programming-" class="hash-link" aria-label="Direct link to Multi-threaded programming ðŸŽ¬" title="Direct link to Multi-threaded programming ðŸŽ¬">â€‹</a></h2><video controls="" muted="" autoplay="" loop="" style="width:100%" data-theme="light"><source src="/img/timeline-mac-light.mp4" type="video/mp4"></video><video controls="" muted="" autoplay="" loop="" style="width:100%" data-theme="dark"><source src="/img/timeline-mac-dark.mp4" type="video/mp4"></video><p>Rust&#x27;s slogan is &quot;Fearless Concurrency&quot;, so how do we debug multi-threaded Rust programs? It&#x27;s possible to pause and step through a multi-threaded program, but doing so manually would affect the timing and synchronization of other threads.</p><p>FireDBG can track multiple threads and keep them running as smoothly as possible, allowing us to observe how multiple threads work together. It&#x27;s a proof-of-concept, but let&#x27;s take a look at a small Rust program that spawns multiple worker threads to perform matrix computation:</p><div class="language-rust codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-rust codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">inverse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Matrix</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">-&gt;</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Matrix</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token namespace">fire</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token macro property">dbg!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;return&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Matrix</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">inv</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">runner</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">receiver</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Receiver</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Matrix</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> sender</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Sender</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token class-name" style="color:rgb(38, 127, 153)">Matrix</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Option</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">Matrix</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">while</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Ok</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> receiver</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">recv</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// send back the input with solution</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> mm </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">inverse</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain">m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        sender</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> mm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:rgb(0, 0, 255)">main</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> collector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">channel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">mut</span><span class="token plain"> senders </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Vec</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">new</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token constant" style="color:rgb(129, 31, 63)">THREADS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// spawn worker threads</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> receiver</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">channel</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        senders</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">push</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> result </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">clone</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token namespace">std</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token namespace">thread</span><span class="token namespace punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">spawn</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token closure-params closure-punctuation punctuation" style="color:rgb(4, 81, 165)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">runner</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">receiver</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> c </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token constant" style="color:rgb(129, 31, 63)">ITEMS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// spmc; fan out</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> m </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">Matrix</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">D</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">::</span><span class="token function" style="color:rgb(0, 0, 255)">random</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        senders</span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">c </span><span class="token operator" style="color:rgb(0, 0, 0)">%</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">THREADS</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">send</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">..</span><span class="token constant" style="color:rgb(129, 31, 63)">ITEMS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token comment" style="color:rgb(0, 128, 0)">// mpsc; consolidate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword" style="color:rgb(0, 0, 255)">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">m</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> mm</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> collector</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">recv</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">unwrap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Source  = {m:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token macro property">println!</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;Inverse = {mm:?}&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><tbody><tr style="background-color:unset"><td><img style="width:100%" src="/img/multi-thread-light.png#light"><img style="width:100%" src="/img/multi-thread-dark.png#dark"></td></tr><tr style="background-color:unset"><td style="color:var(--ifm-blockquote-color)">Top panel: a matrix and its inverse computed by a worker thread; bottom panel: timeline showing events across all threads within a specific time window</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-vision">The vision<a href="#the-vision" class="hash-link" aria-label="Direct link to The vision" title="Direct link to The vision">â€‹</a></h2><p>What you see today is an MVP of FireDBG. It may be slow and buggy, and notably, async Rust support is still a work-in-progress. But it outlines the vision I have for what a debugger could be and how it can level up our debugging experience. I still have a dozen of visualization ideas: channels, mutexes, arc/rc graph, async timeline, etc.</p><p>We aim to bring FireDBG to other programming languages and engineering domains. Our ultimate goal is to improve the debugging experience for all developers!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-work-together">Let&#x27;s work together!<a href="#lets-work-together" class="hash-link" aria-label="Direct link to Let&#x27;s work together!" title="Direct link to Let&#x27;s work together!">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="call-for-stargazers">Call for stargazers<a href="#call-for-stargazers" class="hash-link" aria-label="Direct link to Call for stargazers" title="Direct link to Call for stargazers">â€‹</a></h3><p>Please star our <a href="https://github.com/SeaQL/FireDBG.for.Rust" target="_blank" rel="noopener noreferrer">GitHub repo</a>! Your support is vital. Even if you are not a Rust developer, let us know your thoughts too.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="call-for-early-adopters">Call for early adopters<a href="#call-for-early-adopters" class="hash-link" aria-label="Direct link to Call for early adopters" title="Direct link to Call for early adopters">â€‹</a></h3><p>If you think your use case can be drastically improved by having a visual debugger, let&#x27;s collaborate and shape the product together<sup id="fnref-8-3c097c"><a href="#fn-8-3c097c" class="footnote-ref">8</a></sup>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="call-for-co-founder">Call for co-founder<a href="#call-for-co-founder" class="hash-link" aria-label="Direct link to Call for co-founder" title="Direct link to Call for co-founder">â€‹</a></h3><p>I am looking for a co-founder. If you are like me, deeply passionate about developer experience and willing to commit to this idea, let&#x27;s team up and embark on a journey to transform software engineering. You can find my profile on <a href="https://www.startupschool.org/cofounder-matching/candidate/hy22iDvPx" target="_blank" rel="noopener noreferrer">YC Co-Founder Matching</a><sup id="fnref-9-3c097c"><a href="#fn-9-3c097c" class="footnote-ref">9</a></sup>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="acknowledgement">Acknowledgement<a href="#acknowledgement" class="hash-link" aria-label="Direct link to Acknowledgement" title="Direct link to Acknowledgement">â€‹</a></h2><p>Many great software inspired me, but two of them is worth mentioning: <a href="https://getfirebug.com/index.html" target="_blank" rel="noopener noreferrer">Firebug</a> and <a href="https://www.brendangregg.com/flamegraphs.html" target="_blank" rel="noopener noreferrer">Flame Graph</a>. Firebug changed web development forever, and is the predecessor to the awesome browser developer tools we enjoy today.</p><p>Flame Graph is the classic example of how a simple but powerful idea became ubiquitous, and it really demonstrates the magic of visualization. Good visualization enlightens our brains.</p><p>A huge thanks to the <a href="https://github.com/vadimcn/codelldb" target="_blank" rel="noopener noreferrer">CodeLLDB</a> project, which powers FireDBG&#x27;s lldb driver. In case you&#x27;re wondering, FireDBG uses both <a href="https://github.com/SeaQL/sea-orm" target="_blank" rel="noopener noreferrer">SeaORM</a> and <a href="https://github.com/SeaQL/sea-streamer" target="_blank" rel="noopener noreferrer">SeaStreamer</a> under the hood. And of course none of this could be possible without the Rust programming language and the awesome Rust community!</p><div class="footnotes"><hr><ol><li id="fn-1-3c097c"><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/debuggercmds/time-travel-debugging-overview" target="_blank" rel="noopener noreferrer">WinDBG</a>, <a href="https://rr-project.org/" target="_blank" rel="noopener noreferrer">rr</a><a href="#fnref-1-3c097c" class="footnote-backref">â†©</a></li><li id="fn-2-3c097c">Probably because of bad pivot selection<a href="#fnref-2-3c097c" class="footnote-backref">â†©</a></li><li id="fn-3-3c097c">A deep call stack could harm performance or at least pose a risk of overflow<a href="#fnref-3-3c097c" class="footnote-backref">â†©</a></li><li id="fn-4-3c097c">Except not really, in some cases the function prologue is wrong<a href="#fnref-4-3c097c" class="footnote-backref">â†©</a></li><li id="fn-5-3c097c">A future blog post will be published to explain the intricacies<a href="#fnref-5-3c097c" class="footnote-backref">â†©</a></li><li id="fn-6-3c097c">Although normal, safe Rust programs should not have reference cycles<a href="#fnref-6-3c097c" class="footnote-backref">â†©</a></li><li id="fn-7-3c097c">Who would rather not be named<a href="#fnref-7-3c097c" class="footnote-backref">â†©</a></li><li id="fn-8-3c097c">Feel free to reach us via GitHub or email<a href="#fnref-8-3c097c" class="footnote-backref">â†©</a></li><li id="fn-9-3c097c">Please do not DM me; let&#x27;s connect on the platform<a href="#fnref-9-3c097c" class="footnote-backref">â†©</a></li></ol></div></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/news/">news</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/SeaQL/firedbg.sea-ql.org/edit/main/FireDBG/blog/blog/2023-12-12-introducing-firedbg.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2023-12-13-getting-started/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Getting Started</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2023-12-11-architecture-of-firedbg/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Architecture of FireDBG</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#debugging-programs-is-hard" class="table-of-contents__link toc-highlight">Debugging programs is hard</a><ul><li><a href="#thats-why-we-created-firedbg---a-time-travel-visual-debugger-for-rust-" class="table-of-contents__link toc-highlight">That&#39;s why we created FireDBG - a Time Travel Visual Debugger for Rust ðŸŽ¬</a></li></ul></li><li><a href="#time-travel-debugging" class="table-of-contents__link toc-highlight">Time travel debugging</a></li><li><a href="#call-tree---the-trail-across-the-forest" class="table-of-contents__link toc-highlight">Call tree - the trail across the forest</a></li><li><a href="#call-tree-visualization-and-algorithms" class="table-of-contents__link toc-highlight">Call tree visualization and algorithms</a></li><li><a href="#tracing-errors---the-error-path" class="table-of-contents__link toc-highlight">Tracing errors - the error path</a></li><li><a href="#collecting-parameters-and-return-values" class="table-of-contents__link toc-highlight">Collecting parameters and return values</a></li><li><a href="#a-type-system-for-the-rust-type-system" class="table-of-contents__link toc-highlight">A type system for the Rust type system</a></li><li><a href="#a-new-lens-into-our-code" class="table-of-contents__link toc-highlight">A new lens into our code</a></li><li><a href="#i-want-to-debug-my-code---not-system-libraries" class="table-of-contents__link toc-highlight">I want to debug <em>my code</em> - not system libraries!</a></li><li><a href="#multi-threaded-programming-" class="table-of-contents__link toc-highlight">Multi-threaded programming ðŸŽ¬</a></li><li><a href="#the-vision" class="table-of-contents__link toc-highlight">The vision</a></li><li><a href="#lets-work-together" class="table-of-contents__link toc-highlight">Let&#39;s work together!</a><ul><li><a href="#call-for-stargazers" class="table-of-contents__link toc-highlight">Call for stargazers</a></li><li><a href="#call-for-early-adopters" class="table-of-contents__link toc-highlight">Call for early adopters</a></li><li><a href="#call-for-co-founder" class="table-of-contents__link toc-highlight">Call for co-founder</a></li></ul></li><li><a href="#acknowledgement" class="table-of-contents__link toc-highlight">Acknowledgement</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/SeaQL/FireDBG.for.Rust/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.com/invite/uCPdDXzbdv" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/sea_ql" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/about-us/">About Us</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/eula/">EULA</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy/">Privacy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 SeaQL.org</div></div></div></footer></div>
<script src="/assets/js/runtime~main.447e8809.js"></script>
<script src="/assets/js/main.c4b29fd9.js"></script>
</body>
</html>